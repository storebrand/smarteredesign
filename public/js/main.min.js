var App = {
  init: function(obj) {
    console.log("Hello world");

    if(obj.type) {
      switch (obj.type) {
        case "article":
          ArticleView.init(document.getElementById('article'));
          break;
        default:

      }
    }

    Header.init(document.getElementById('site-header'));
  }
}

var ArticleRelatedContent = {
  init: function (el) {
    this.el = el;
    this.$el = $(el);

    var $faderLeft = this.$el.find(".fader--left")
    var $faderRight = this.$el.find(".fader--right")
    this.$scrollContent = this.$el.find(".related-content__list");
    var scrollWidth = this.$scrollContent[0].scrollWidth - $(window).width();
    this.$scrollContent.on('scroll', function (e) {
      $faderLeft.css('opacity', Math.min(1, $(this).scrollLeft()/100));
      $faderRight.css('opacity', Math.min(1, (scrollWidth - $(this).scrollLeft())/100));
    })

  }
}

var ArticleView = {
  init: function (el) {
    this.el = el;
    this.$el = $(el);

    if(this.$el.find(".article__aside")) {

      if(window.matchMedia && window.matchMedia("(max-width: 767px)").matches) {
        ArticleRelatedContent.init(document.getElementById('article-related-content'))
      }
    }
  }
}

var Header = {
  init: function (el) {
    this.$el = $(el);
    this.$searchField = this.$el.find('#search');

    console.log("init " + this.$searchField.length);

    this.$searchField.on('focus', $.proxy(this.onFieldFocus, this));
    this.$searchField.on('blur', $.proxy(this.onFieldBlur, this));

    this.$menu = this.$el.find('.menu');
  },

  onFieldFocus: function (e) {
    console.log("focus");
    this.$menu.addClass('menu--open');
  },

  onFieldBlur: function (e) {
    console.log("blur");
    this.$menu.removeClass('menu--open');
  }
}
